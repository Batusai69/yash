# (C) 2010 magicant

# Completion script for the "cd" built-in command.
# Completion function "completion/cd" is used for the "pushd" built-in as well.

function completion/cd {

	typeset OPTIONS ARGOPT PREFIX
	OPTIONS=( #>#
	"L --logical; keep symbolic links in the \$PWD variable as is"
	"P --physical; resolve symbolic links in the \$PWD variable"
	"--default-directory:; specify the default directory to change to"
	"--help"
	) #<#
	if [ "${WORDS[1]}" = "pushd" ]; then
		OPTIONS=("$OPTIONS" #>#
		"--remove-duplicates; remove duplicates in the directory stack"
		) #<#
	fi

	typeset dirstack=false
	command -f completion//parseoptions -es
	case $ARGOPT in
		(-)
			case $TARGETWORD in
			(-*[[:digit:]]*)
				;;
			(*)
				command -f completion//completeoptions
				;;
			esac
			dirstack=true
			;;
		(--default-directory)
			complete -P "$PREFIX" -d
			;;
		(*)
			complete -d
			dirstack=true
			;;
	esac

	if $dirstack && [ "${WORDS[1]}" = "pushd" ]; then
		if command -vf completion//completedirstack >/dev/null 2>&1 ||
			. -AL completion/_dirstack; then
			command -f completion//completedirstack
		fi
	fi

}


# vim: set ft=sh ts=8 sts=8 sw=8 noet:
