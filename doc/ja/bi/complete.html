<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="author" content="magicant">
<meta name="description" content="Yash の complete 組込みコマンドについて">
<title>Yash マニュアル: complete 組込みコマンド</title>
<link rel="Contents" href="../index.html" title="目次">
<link rel="Prev" href="command.html" title="Command 組込みコマンド">
<link rel="Next" href="continue.html" title="Continue 組込みコマンド">
<link rel="Stylesheet" href="../style.css">

<div class="breadcrumb"><a href="../index.html">目次</a> >
<a rel="Up" href="index.html">組込みコマンド一覧</a></div>
<h1>Complete 組込みコマンド</h1>

<p><dfn>Complete 組込みコマンド</dfn>は<a href="../lineedit.html">行編集</a>における<a href="../lineedit.html#completion">コマンドライン補完</a>の方式を表示・設定します。

<h2 id="syntax">構文</h2>
<ul>
<li><code>complete [-C <var>コマンド</var>] [-O <var>オプション</var>] [-Xabcdfghjkuv] [-F <var>関数</var>] [-D <var>説明</var>] [<var>文字列</var>…]</code></li>
<li><code>complete [-C <var>コマンド</var>] [-O <var>オプション</var>] [-P]</code></li>
<li><code>complete [-C <var>コマンド</var>] [-O <var>オプション</var>] [-R]</code></li>
</ul>

<h2 id="description">説明</h2>
<p><code>-P</code> (<code>--print</code>) オプションを付けて実行すると、complete コマンドはこれまでに設定された補完方式の設定を標準出力に出力します。出力はコマンドとして実行することで設定内容を復元できるようになっています。デフォルトではすべての設定内容を出力しますが、<code>-C</code> (<code>--target-command</code>) オプションおよび <code>-O</code> (<code>--target-option</code>) オプションを指定するとそのコマンド・オプションに関する設定のみ出力します。
<p><code>-R</code> (<code>--remove</code>) オプションを付けて実行すると、complete コマンドはこれまでに設定された補完方式の設定を消去します。デフォルトではすべての設定を消去しますが、<code>-C</code> オプションおよび <code>-O</code> オプションを指定するとそのコマンド・オプションに関する設定のみ消去します。
<p><code>-P</code> オプションも <code>-R</code> オプションも付けずに <code>-C</code> オプションを付けて実行すると、<code>-C</code> オプションで指定したコマンドに対する補完方式の設定を行います。補完方式設定用のオプションおよびオペランド (下記参照) が、そのコマンドの引数の補完の仕方を指定します。<code>-O</code> オプションも共に指定した場合は、そのオプションに対する設定となります。補完方式設定用のオプションおよびオペランドはオプションの引数の補完方法を指定します。補完方式の設定は累積的です。すなわち、設定はそれまでの設定を上書きするのではなく、前の設定に追加されます。
<p><code>-P</code> オプションも <code>-R</code> オプションも <code>-C</code> オプションも付けずに実行すると、現在行っている補完に対する補完候補を補完方式設定用のオプションおよびオペランドに従って生成します。これは生成関数 (下記 <code>-F</code> オプション参照) の中でのみ行えます。

<h2 id="options">オプション</h2>
<dl>
<dt><code>-C <var>コマンド</var></code>, <code>--target-command=<var>コマンド</var></code>
<dd>補完の仕方を設定・表示・削除する対象となるコマンドを指定します。
<dt><code>-O <var>オプション</var></code>, <code>--target-option=<var>オプション</var></code>
<dd>補完の仕方を設定・表示・削除する対象となるオプションを指定します。オプションには、短いオプションと長いオプションとがあります。
<ul>
<li>短いオプションは、一文字からなります。複数の短いオプションは一つのハイフンの後にまとめて指定できます (例えば <code>-a -b</code> は <code>-ab</code> とできます)。短いオプションは、ハイフンを除いたオプション一文字として <code>-O</code> オプションの引数に指定します (例えば <code>-O a</code> または <code>--target-option=a</code>)。
<li>長いオプションは、ハイフンで始まる複数の文字列からなります。複数の長いオプションを一つにまとめて指定することはできません。長いオプションは、先頭のハイフンを含めたオプション全体を <code>-O</code> オプションの引数として指定します (例えば <code>-O -Wall</code> または <code>--target-option=--help</code>)。
</ul>
<dt><code>-P</code>, <code>--print</code>
<dd>これまでに行った補完の仕方の設定内容を出力します。
<dt><code>-R</code>, <code>--remove</code>
<dd>これまでに行った補完の仕方の設定を削除します。
<dt><code>-X</code>, <code>--intermixed</code>
<dd>コマンドの引数の補完の仕方を設定する際にこのオプションを指定すると、そのコマンドではオペランドの後にオプションを指定可能であるとみなします。(デフォルトでは、最初のオペランド以降の引数はすべてオペランドとして補完されます)
<dt><code>-D <var>説明</var></code>, <code>--description=<var>説明</var></code>
<dd>補完の仕方を設定する際にこのオプションを指定すると、このオプションで指定した<var>説明</var>が補完の際に候補の説明として表示されます。
<ul>
<li>オペランド (下記参照) と共に指定した場合は、そのオペランドが補完候補として使われる際の説明として使われます。
<li>オペランドがない場合は、コマンドまたはオプションを補完する際にそれらの説明として使われます。<code>-O</code> オプションと共に指定した場合は、そのオプションの説明として、そうでない場合は、<code>-C</code> オプションで指定したコマンドの説明として使われます。
</ul>
</dl>
<h3>補完方式設定のためのオプション</h3>
<p>以下のオプションは、コマンドのオペランドまたはオプションの引数を補完するための候補の種類を指定します。
<dl>
<dt><code>-a</code>, <code>--alias</code>
<dd><a href="../syntax.html#aliases">エイリアス</a> (<code>--normal-alias --global-alias</code> に同じ)
<dt><code>--array-variable</code>
<dd><a href="../params.html#arrays">配列</a>
<dt><code>--bindkey</code>
<dd><a href="bindkey.html">Bindkey コマンド</a>で利用可能な<a href="../lineedit.html#commands">行編集コマンド</a>
<dt><code>-b</code>, <code>--builtin</code>
<dd><a href="../builtin.html">組込みコマンド</a> (<code>--special-builtin --semi-special-builtin --regular-builtin</code> に同じ)
<dt><code>-c</code>, <code>--command</code>
<dd>コマンド (<code>--builtin --external-command --function</code> に同じ)
<dt><code>-d</code>, <code>--directory</code>
<dd>ディレクトリ
<dt><code>--executable-file</code>
<dd>実行可能ファイル
<dt><code>--external-command</code>
<dd>外部コマンド
<dt><code>-f</code>, <code>--file</code>
<dd>ファイル (ディレクトリ含む)
<dt><code>--finished-job</code>
<dd>終了したジョブの<a href="../job.html#jobid">ジョブ ID</a>
<dt><code>--function</code>
<dd><a href="../exec.html#function">関数</a>
<dt><code>--global-alias</code>
<dd>グローバル<a href="../syntax.html#aliases">エイリアス</a>
<dt><code>-g</code>, <code>--group</code>
<dd>(ファイルのパーミッションなどにおける) グループ
<dt><code>-h</code>, <code>--hostname</code>
<dd>ホスト名
<dt><code>-j</code>, <code>--job</code>
<dd><a href="../job.html#jobid">ジョブ ID</a>
<dt><code>-k</code>, <code>--keyword</code>
<dd>シェルの<a href="../syntax.html#tokens">予約語</a>
<dt><code>--normal-alias</code>
<dd>通常の (グローバルでない) <a href="../syntax.html#aliases">エイリアス</a>
<dt><code>--regular-builtin</code>
<dd>通常の<a href="../builtin.html">組込みコマンド</a>
<dt><code>--running-job</code>
<dd>実行中のジョブの<a href="../job.html#jobid">ジョブ ID</a>
<dt><code>--scalar-variable</code>
<dd>(配列を除いた通常の) <a href="../params.html#variables">変数</a>
<dt><code>--semi-special-builtin</code>
<dd>準特殊<a href="../builtin.html">組込みコマンド</a>
<dt><code>--signal</code>
<dd>シグナル
<dt><code>--special-builtin</code>
<dd>特殊<a href="../builtin.html">組込みコマンド</a>
<dt><code>--stopped-job</code>
<dd>停止中のジョブの<a href="../job.html#jobid">ジョブ ID</a>
<dt><code>-u</code>, <code>--username</code>
<dd>ユーザのログイン名
<dt><code>-v</code>, <code>--variable</code>
<dd><a href="../params.html#variables">変数</a>
<dt><code>-F <var>関数</var></code>, <code>--generator-function=<var>関数</var></code>
<dd>補完候補の生成関数の名前を指定します。このオプションを指定すると、コマンドのオペランドまたはオプションの引数を補完する際に<var>関数</var>が実行されます。このとき関数の引数として、既に入力されているコマンド名・引数が渡されます (最後の引数は、補完の対象となっている途中まで入力された引数です)。関数の中で complete コマンドを <code>-C</code>, <code>-P</code>, <code>-R</code> オプションを付けずに補完方式設定のためのオプションまたはオペランドを指定して実行すると、そのオプションまたはオペランドに従って補完候補が動的に追加されます。
</dl>

<h2 id="operands">オペランド</h2>
<p>Complete コマンドのオペランドは、各オペランドがそれぞれ補完候補として扱われます。

<h2 id="exitstatus">終了ステータス</h2>
<p>エラーがない限り complete コマンドの終了ステータスは 0 です。

<h2 id="examples">例</h2>
<p>Rmdir コマンドは <code>-p</code> オプションを取り、オペランドとしてディレクトリ名を受け付けます:
<ul>
<li><code>complete -C rmdir -d</code>
<li><code>complete -C rmdir -O p</code>
</ul>
<p>このとき <code>-p</code> オプションに説明を付加する場合は、以下のようにします。
<ul>
<li><code>complete -C rmdir -O p -D '親ディレクトリも削除する'</code>
</ul>
<p>オプションとオペランドを以下のように同時に指定してはいけません。このように指定すると、<code>-p</code> オプションがディレクトリ名を引数として受け取るものとみなされてしまいます。
<ul>
<li><code>complete -C rmdir -O p -d  # 間違った例</code>
</ul>
<p><span lang="en">GNU core utilities</span> の ls コマンドの <code>-a</code> オプションと <code>--all</code> オプションのように、一つのコマンドに同じ意味を持つ短いオプションと長いオプションがある場合は、それらを同時に指定できます。複数の短いオプションまたは複数の長いオプションを同時に指定することは (それらが同じ意味であるかにかかわらず) できません:
<ul>
<li><code>complete -C ls -O a -O --all  # 正しい例</code>
<li><code>complete -C less -O --silent -O --quiet  # 間違った例</code>
</ul>
<p>オプションが引数を取る場合は、その引数の種類をオプションで指定します。例えば <a href="cd.html">cd コマンド</a>の <code>--default-directory</code> オプションはディレクトリ名を引数として受け取ります:
<ul>
<li><code>complete -C cd -O --default-directory -d</code>
</ul>
<p>コマンドのオペランドまたはオプションの引数の値が固定化されている場合は、オペランドでそれを直接指定します。例えば <span lang="en">GNU core utilities</span> の ls コマンドの <code>--color</code> オプションは、<code>always</code>, <code>auto</code>, <code>force</code>, <code>if-tty</code>, <code>never</code>, <code>no</code>, <code>none</code>, <code>tty</code>, <code>yes</code> という九つの値を引数として受け取ります:
<ul>
<li><code>complete -C ls -O --color always auto force if-tty never no none tty yes</code>
</ul>
<p>これらの値に説明を付け加えたい場合は、同じ説明を与えたい値ごとに指定します。
<ul>
<li><code>complete -C ls -O --color -D '常にカラー表示する' always force yes</code>
<li><code>complete -C ls -O --color -D '常にカラー表示しない' never no none</code>
<li><code>complete -C ls -O --color -D '出力が端末ならカラー表示する' auto if-tty tty</code>
</ul>
<p>なお、<code>--color</code> オプションに対する説明も指定できます (オペランドを指定していない点に注意):
<ul>
<li><code>complete -C ls -O --color -D '出力をカラー表示するか設定する'</code>
</ul>

<h2 id="notes">補足</h2>
<p>POSIX には complete コマンドに関する規定はありません。
