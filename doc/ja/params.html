<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="author" content="magicant">
<meta name="description" content="Yash のパラメータ・変数について">
<title>Yash マニュアル: パラメータと変数</title>
<link rel="Contents" href="index.html" title="目次">
<link rel="Prev" href="syntax.html" title="コマンドの文法">

<div class="breadcrumb"><a rel="Up" href="index.html">目次</a> ></div>
<h1>パラメータと変数</h1>

<p>パラメータとは、<a class="TODO">パラメータ展開</a>で値に置き換えられるデータを言います。パラメータには位置パラメータ・特殊パラメータ・変数の三種類があります。

<h2 id="positional">位置パラメータ</h2>
<p><dfn>位置パラメータ</dfn>は 1 以上の自然数によって識別されるパラメータです。
例えば位置パラメータが三つある場合、それらは順に <code>1</code>, <code>2</code>, <code>3</code> という名称で識別されます。位置パラメータの個数は<a class="TODO">特殊パラメータ <code>#</code></a> で取得できます。
<p>位置パラメータは、シェルの起動時に、シェルのコマンドライン引数を元に初期化されます (<a href="invocation.html#args">起動時のコマンドライン引数</a>参照)。引数のうち、位置パラメータの値として与えられたオペランドが順に一つずつ位置パラメータとなります。
<p>シェルのコマンド実行中に<a class="TODO">関数</a>が呼び出されるとき、位置パラメータはその関数の呼び出しに対する引数に変更されます。すなわち、関数の実行中は位置パラメータによって関数の引数を参照できます。関数呼び出しの直前の位置パラメータの値は保存されており、関数の実行が終了する際に元の値に戻ります。
<p><code>0</code> は位置パラメータとは見なされません (特殊パラメータの一つです)。

<h2 id="special">特殊パラメータ</h2>
<p>特殊パラメータは一文字の記号によって識別されるパラメータです。特殊パラメータにはユーザが明示的に値を代入することはできません。
<p>Yash では以下の特殊パラメータが利用可能です。
<dl>
<dt><code>0</code>
<dd>このパラメータの値は、シェルの起動時に与えられたシェルの実行ファイルの名称またはスクリプトファイルの名称です。
<dt><code>#</code>
<dd>このパラメータの値は、現在の位置パラメータの個数を表す 0 以上の整数です。
<dt><code>$</code>
<dd>このパラメータの値は、シェル自身のプロセス ID を表す正の整数です。この値はサブシェルにおいても変わりません。
<dt><code>-</code>
<dd>このパラメータの値は、現在シェルで有功になっているオプションの文字をつなげたものです。この値には、<a href="invocation.html">シェルの起動</a>時にコマンドライン引数で指定できる一文字のオプションのうち現在有効になっているものが全て含まれます。<a class="TODO"><code>set</code> 組込みコマンド</a>でオプションを変更した場合は、その変更がこのパラメータの値にも反映されます。
<dt><code>?</code>
<dd>このパラメータの値は、最後に終了した<a href="syntax.html#pipelines">パイプライン</a>の終了ステータスを表す 0 以上の整数です。
<dt><code>!</code>
<dd>このパラメータの値は、最後に実行した<a href="syntax.html#async">非同期コマンド</a>のプロセス ID です。
<dt><code>*</code>
<dd>このパラメータの値は、現在の位置パラメータの値です。位置パラメータが一つもない場合、このパラメータの値は空文字列です。位置パラメータが複数ある場合、このパラメータの値は全ての位置パラメータの値を連結したものです。各位置パラメータの値の間は以下に従って区切られます。
 <ul>
 <li>変数 <code>IFS</code> が存在し、その値が空でない場合、各位置パラメータは変数 <code>IFS</code> の値の最初の文字で区切られます。
 <li>変数 <code>IFS</code> が存在し、その値が空の場合、各位置パラメータは間に何も置かずに連結されます。
 <li>変数 <code>IFS</code> が存在しない場合、各位置パラメータは空白で区切られます。
 </ul>
<dt><code>@</code>
<dd>このパラメータは、パラメータ <code>*</code> と同様に現在の全ての位置パラメータを表します。ただし、このパラメータが二重引用符による<a href="syntax.html#quotes">クォート</a>の中で<a class="TODO">展開</a>される場合の扱いがパラメータ <code>*</code> と異なります。この場合、各位置パラメータは文字で区切られるのではなく、(クォートの内部であるにもかかわらず) <a class="TODO">単語分割</a>されます。また位置パラメータが一つもない場合、このパラメータは展開後の単語には残りません。
</dl>

<h2 id="variables">変数</h2>
<p><dfn>変数</dfn>とはユーザが自由に代入可能なパラメータです。各変数は名前で区別され、ぞれぞれが文字列の値を持ちます。
<p>変数の名前は、英数字と下線 (<code>_</code>) から構成されます。ただし変数名の頭文字を数字にすることはできません。環境によってはこれ以外の文字も変数名に使用できます。
<p>シェルが扱う変数のうち、エクスポートの対象となっているものは<dfn>環境変数</dfn>といいます。これらの変数はシェルが外部コマンドを起動する際に外部コマンドに渡されます。シェルが起動されたときにシェルを起動したプログラムから渡された変数は自動的に環境変数になります。
<p>変数は、<a href="syntax.html#simple">単純コマンド</a>によって代入できます。また <a class="TODO">typeset 組込みコマンド</a>などでも変数に代入することができます。変数を削除するには <a class="TUDO">unset 組込みコマンド</a>を使います。

<h3 id="shellvars">シェルが使用する変数</h3>
<p>以下の名前の変数は、yash の実行において特別な意味を持っています。
<dl>
<dt id="sv-cdpath"><code>CDPATH</code>
<dd>この変数は <a class="TODO">cd 組込みコマンド</a>で移動先ディレクトリを検索するために使われます。
<dt id="sv-columns"><code>COLUMNS</code>
<dd>この変数は端末ウィンドウの横幅 (文字数) を指定します。この変数が設定されている場合、デフォルトの横幅ではなくこの変数の値で指定された横幅が<a class="TODO">行編集</a>で使われます。
<dt id="sv-dirstack"><code>DIRSTACK</code>
<dd>この配列変数はディレクトリスタックの実装に使われています。<a class="TODO">pushd 組込みコマンド</a>でディレクトリを移動したとき、前のディレクトリを覚えておくためにそのパス名がこの配列に入れられます。配列の内容を勝手に書き換えると、ディレクトリスタック機能は正しく動作しないことがあります。
<dt id="sv-env"><code>ENV</code>
<dd>POSIX 準拠モードで対話的シェルが起動されたとき、この変数の値で示されるパスのファイルが初期化スクリプトとして読み込まれます (<a href="invocation.html#init">シェルの初期化処理</a>参照)。
<dt id="sv-fcedit"><code>FCEDIT</code>
<dd><a class="TODO">Fc 組込みコマンド</a>でコマンドを編集する際、この変数の値で示されたエディタがコマンドの編集に使われます。
<dt id="sv-histfile"><code>HISTFILE</code>
<dd><a class="TODO">コマンド履歴</a>を保存するファイルのパスを指定します。
<dt id="sv-histsize"><code>HISTSIZE</code>
<dd><a class="TODO">コマンド履歴</a>に保存される履歴項目の個数を指定します。
<dt id="sv-home"><code>HOME</code>
<dd>ユーザのホームディレクトリのパスを指定します。
<dt id="sv-ifs"><code>IFS</code>
<dd>この変数は<a class="TODO">単語分割</a>の区切りを指定します。シェルの起動時にこの変数の値は空白・タブ・改行の三文字に初期化されます。
<dt id="sv-lang"><code>LANG</code>
<dt id="sv-lc_all"><code>LC_ALL</code>
<dt id="sv-lc_collate"><code>LC_COLLATE</code>
<dt id="sv-lc_ctype"><code>LC_CTYPE</code>
<dt id="sv-lc_messages"><code>LC_MESSAGES</code>
<dt id="sv-lc_monetary"><code>LC_MONETARY</code>
<dt id="sv-lc_numeric"><code>LC_NUMERIC</code>
<dt id="sv-lc_time"><code>LC_TIME</code>
<dd>これらの変数はシェルが動作するロケールを指定します。シェルが読み書きするファイルのエンコーディングやエラーメッセージの内容などはこの変数で指定されたロケールに従います。
<dt id="sv-lineno"><code>LINENO</code>
<dd>この変数の値は、現在シェルが読み込んで実行しているファイルにおける、現在実行中のコマンドのある行番号を示します。
<dd>一度この変数に代入したり変数を削除したりすると、この変数を用いて行番号を取得することはできなくなります。
<dt id="sv-lines"><code>LINES</code>
<dd>この変数は端末ウィンドウの行数を指定します。この変数が設定されている場合、デフォルトの行数ではなくこの変数の値で指定された行数が<a class="TODO">行編集</a>で使われます。
<dt id="sv-mail"><code>MAIL</code>
<dd>この変数は<a class="TODO">メールチェック</a>の対象となるファイルのパスを指定します。
<dt id="sv-mailcheck"><code>MAILCHECK</code>
<dd>この変数は<a class="TODO">メールチェック</a>を行う間隔を指定します。
<dt id="sv-mailpath"><code>MAILPATH</code>
<dd>この変数は<a class="TODO">メールチェック</a>の対象となるファイルのパスを指定します。
<dt id="sv-nlspath"><code>NLSPATH</code>
<dd>POSIX によるとこの変数の値はロケール依存のメッセージデータファイルのパスを指示することになっていますが、yash では使用していません。
<dt id="sv-oldpwd"><code>OLDPWD</code>
<dd><a class="TODO">Cd 組込みコマンド</a>などで作業ディレクトリを変更したときに、変更前の作業ディレクトリパスがこの変数に設定されます。この変数はデフォルトでエクスポート対象になります。
<dt id="sv-optarg"><code>OPTARG</code>
<dd><a class="TODO">Getopts 組込みコマンド</a>で引数付きのオプションを読み込んだとき、その引数の値がこの変数に設定されます。
<dt id="sv-optind"><code>OPTIND</code>
<dd>この変数の値は、<a class="TODO">getopts 組込みコマンド</a>で次に読み込むオプションのインデックスを表します。シェルの起動時にこの変数は <code>1<code> に初期化されます。
<dt id="sv-path"><code>PATH</code>
<dd>この変数は、<a class="TODO">コマンドの実行時</a>にコマンドのありかを示すパスを指定します。
<dt id="sv-ppid"><code>PPID</code>
<dd>この変数の値は、シェルの親プロセスのプロセス ID を表す正の整数です。この変数はシェルの起動時に初期化されます。この変数の値は<a class="TODO">サブシェル</a>においても変わりません。
<dt id="sv-prompt_command"><code>PROMPT_COMMAND</code>
<dd>POSIX 準拠モードでない対話的シェルにおいて、シェルが各コマンドのプロンプトを出す直前に、この変数の値がコマンドとして解釈・実行されます。
<dt id="sv-ps1"><code>PS1</code>
<dd>この変数の値は、対話的シェルが出力する標準のコマンドプロンプトを指定します。
<dt id="sv-ps2"><code>PS2</code>
<dd>この変数の値は、対話的シェルが出力する補助的なコマンドプロンプトを指定します。
<!--dt id="sv-ps3"><code>PS3</code-->
<dt id="sv-ps4"><code>PS4</code>
<dd>シェルの <code>-x</code> (<code>-o xtrace</code>) オプションが有効なとき、この変数の値が各トレース出力の前に出力されます。
<dt id="sv-pwd"><code>PWD</code>
<dd>この変数の値は現在の作業ディレクトリの絶対パスを表します。この変数はシェルの起動時に正しいパスに初期化され、<a class="TODO">cd 組込みコマンド</a>などで作業ディレクトリを変更する度に再設定されます。
<dt id="sv-random"><code>RANDOM</code>
<dd>この変数は乱数を取得するために使用できます。この変数の値は 0 以上 32768 未満の一様分布乱数になっています。
<dd>この変数に非負整数を代入すると乱数を生成する<em>種</em>を再設定できます。
<dd>一度この変数を削除すると、この変数を用いて乱数を取得することはできなくなります。
<dt id="sv-term"><code>TERM</code>
<dd>この変数は対話的シェルが動作している端末の種類を指定します。ここで指定された端末の種類に従って<a class="TODO">行編集</a>機能は端末を制御します。
<dt id="sv-yash_le_timeout"><code>YASH_LE_TIMEOUT</code>
<dd>この変数は<a class="TODO">行編集</a>機能で曖昧な文字シーケンスが入力されたときに入力文字を確定させるためにシェルが待つ時間をミリ秒単位で指定します。この変数は対話的シェルの起動時に 100 に初期化されます。
<dt id="sv-yash_version"><code>YASH_VERSION</code>
<dd>この変数はシェルの起動時にシェルのバージョン番号に初期化されます。
</dl>

<h2 id="arrays">配列</h2>
