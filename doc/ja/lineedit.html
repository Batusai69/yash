<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="author" content="magicant">
<meta name="description" content="Yash の行編集機能について">
<title>Yash マニュアル: 行編集</title>
<link rel="Contents" href="index.html" title="目次">
<link rel="Prev" href="builtin.html" title="組込みコマンド">
<link rel="Next" href="posix.html" title="POSIX 準拠モード">
<link rel="Stylesheet" href="style.css">

<div class="breadcrumb"><a rel="Up" href="index.html">目次</a> ></div>
<h1>行編集</h1>

<p><dfn>行編集</dfn>機能は、<a href="interact.html">対話モード</a>のシェルにコマンドを入力する際に使える、コマンドの簡易編集機能です。行編集機能は、コマンドを編集するための簡単なエディタとして働きます。行編集機能は<a href="interact.html#history">コマンド履歴</a>とも連携しており、<a href="bi/fc.html">fc コマンド</a>を使ってエディタを起動する代わりに行編集で直接コマンドを編集・再実行できます。
<p>行編集には複数の編集モードがあり、モードごとにキー操作の割り当てが異なります。行編集の有効・無効を切り替えたりモードを選択したりするには、<a href="bi/set.html">set コマンド</a>で編集モードに対応するオプションを設定します。あるモードに対応するオプションを有効にすると、そのモードの行編集が有効になります (同時に他のモードのオプションは自動的に無効になります)。現在有効になっているモードのオプションを無効にすると、行編集は無効になります。現在 yash が搭載している編集モードは vi 風と emacs 風の二種類で、それぞれ対応するオプションは <code>-o vi</code> と <code>-o emacs</code> です。
<p>シェルが対話モードで起動したとき、標準入力と標準エラーがともに端末ならば、vi 風行編集が自動的に有効になります。
<p>行編集は、標準入力と標準エラーがともに端末のときだけ使えます。この条件が満たされていないときは、行編集は働きません。行編集が働くとき、シェルは termios インタフェースを使用して端末の入出力モードを一時的に変更し、terminfo インタフェースを使用して入力されたキーの判別などを行います。

<h2 id="options">行編集のオプション</h2>
<p>編集モードを指定するオプションの他に、行編集に関わるものとして以下のオプションが <a href="bi/set.html">set コマンド</a>で設定できます。
<dl>
<dt><code>-o le-alwaysrp</code>, <code>--le-alwaysrp</code>
<dd>このオプションが無効な時は、長いコマンドを入力してコマンドが右プロンプトに達すると、右プロンプトは見えなくなります。このオプションが有効な時は、右プロンプトは見えなくなる代わりに下に移動します。
<dt><code>-o le-compdebug</code>, <code>--le-compdebug</code>
<dd><a href="#completion">補完</a>を行う際にデバッグ用の情報を出力します
<dt><code>-o le-convmeta</code>, <code>--le-convmeta</code>
<dd>Terminfo データベースで得られた情報を無視し、入力の 8 ビット目を常に meta-key フラグとみなします。
<dt><code>-o le-noconvmeta</code>, <code>--le-noconvmeta</code>
<dd>Terminfo データベースで得られた情報を無視し、入力の 8 ビット目を他のビットと同様に扱います。
<dd><code>-o le-convmeta</code> (<code>--le-convmeta</code>) オプションと <code>-o le-noconvmeta</code> (<code>--le-noconvmeta</code>) オプションは片方しか有効にできません (片方を有効にするともう片方は自動的に無効になります)。どちらも無効な時は terminfo データベースの情報に従って 8 ビット目を meta-key とみなすかどうか判断します。
<dt><code>-o le-promptsp</code>, <code>--le-promptsp</code>
<dd>このオプションが有効な時、シェルは<a href="interact.html#prompt">プロンプト</a>を出力する前に、プロンプトが必ず行頭に来るようにカーソルを移動するための特殊な文字列を出力します。
<dd>このオプションは最初から有効になっています。
<dt><code>-o le-visiblebell</code>, <code>--le-visiblebell</code>
<dd>シェルが警告を発する際、警告音を鳴らす代わりに端末を点滅させます。
</dl>

<h2 id="modes">編集モード</h2>
<p><dfn>Vi 風編集モード</dfn>は vi に似たキー操作で編集を行う編集モードです。Vi 風編集モードでは、挿入モードとコマンドモードの二つのモードを適宜切り替えて編集を行います。編集が始まるときはモードは必ず挿入モードになっています。挿入モードでは入力した文字が基本的にそのままバッファに挿入されます。コマンドモードでは入力した文字はカーソルを移動したり文字を消去したりするコマンドとして解釈されます。
<p><dfn>Emacs 風編集モード</dfn>は emacs に似たキー操作で編集を行う編集モードです。入力した文字は基本的にそのままバッファに挿入されますが、コマンドとして解釈される一部のキー操作が vi 風編集モードの挿入モードと異なります。
<p>これらのモードの他に、コマンドの検索の際に用いる検索モードが vi 風と emacs 風とそれぞれにあります。

<h2 id="commands">行編集コマンド</h2>
<p>行編集中に入力された文字は全て以下の行編集コマンドのいずれかとして解釈されます。コマンドとキーの対応は <a href="bi/bindkey.html">bindkey コマンド</a>で変更できます (検索モードを除く)。
<p>以下の一覧には各コマンドに対応するキー入力の初期設定も示してあります。なお、vi-insert は vi 風編集モードの挿入モードを、vi-command は vi 風編集モードのコマンドモードを、vi-search は vi 風編集モードの検索モードを、emacs は emacs 風編集モードを、emacs-search は emacs 風編集モードの検索モードを示します。
<p>コマンドの中には引数を指定することでその動作を変更できるものがあります。例えば forward-char コマンドは通常はカーソルを一文字分前に移動しますが、引数を指定するとその引数の文字数分だけカーソルを移動します。引数は、目的のコマンドの直前に digit-argument コマンドを使うことで指定できます。

<h3 id="basic-commands">基本的な編集コマンド</h3>
<dl>
<dt>noop
<dd>何も行いません。
<dd>vi-command: <kbd><code>\^[</code></kbd>
<dt>alert
<dd>警告音を発しまたは端末を点滅させます。
<dt>self-insert
<dd>入力した文字を現在のカーソルの位置に挿入します。(<a href="#escape">エスケープシーケンス</a>によるエスケープの対象となる文字は挿入できません)
<dd>vi-insert, emacs: <kbd><code>\\</code></kbd>
<dt>insert-tab
<dd>タブを現在のカーソルの位置に挿入します。
<dd>emacs: <kbd><code>\^[</code><code>\^I</code></kbd>
<dt>expect-verbatim
<dd>このコマンドの直後に入力する一文字を現在のカーソル位置に挿入します。このコマンドを使うと self-insert コマンドで入力できない文字も入力できます (ナル文字 '\0' を除く)。
<dd>vi-insert, vi-search, emacs-search: <kbd><code>\^V</code></kbd>
<dd>emacs: <kbd><code>\^Q</code></kbd>, <kbd><code>\^V</code></kbd>
<dt>digit-argument
<dd>このコマンドは数字またはハイフンの入力に対してのみ有効です。入力した数字を次のコマンドへの引数として受け付けます (ハイフンの場合は符号を反転します)。
<dd>Digit-argument コマンドを連続して使うことで複数桁の引数を指定できます。例えば vi 風編集モードのコマンドモードで <kbd>12h</kbd> と入力すると、<kbd>h</kbd> に対応するコマンドに引数 12 を与えたことになります (すなわちカーソルが左に 12 文字分移動します)。
<dd>vi-command: <kbd>1</kbd>, <kbd>2</kbd>, <kbd>3</kbd>, <kbd>4</kbd>, <kbd>5</kbd>, <kbd>6</kbd>, <kbd>7</kbd>, <kbd>8</kbd>, <kbd>9</kbd>
<dd>emacs: <kbd><code>\^[</code>0</kbd>, <kbd><code>\^[</code>1</kbd>, <kbd><code>\^[</code>2</kbd>, <kbd><code>\^[</code>3</kbd>, <kbd><code>\^[</code>4</kbd>, <kbd><code>\^[</code>5</kbd>, <kbd><code>\^[</code>6</kbd>, <kbd><code>\^[</code>7</kbd>, <kbd><code>\^[</code>8</kbd>, <kbd><code>\^[</code>9</kbd>, <kbd><code>\^[</code>-</kbd>
<dt>bol-or-digit
<dd>引数がない場合は beginning-of-line コマンドと同じように、引数がある場合は digit-argument コマンドと同じように動作します。
<dd>vi-command: <kbd>0</kbd>
<dt>accept-line
<dd>行編集を終了し、現在のバッファの内容をシェルへの入力として与えます。行の末尾には自動的に改行が付け加わります。
<dd>vi-insert, vi-command, emacs, emacs-search: <kbd><code>\^J</code></kbd>, <kbd><code>\^M</code></kbd>
<dt>abort-line
<dd>行編集を中止し、空の入力をシェルに与えます。
<dd>vi-insert, vi-command, vi-search, emacs, emacs-search: <kbd><code>\!</code></kbd>, <kbd><code>\^C</code></kbd>
<dt>eof
<dd>シェルに入力の終わりを知らせます (これによりシェルは終了します)。
<dt>eof-if-empty
<dd>バッファが空ならば、行編集を終了し、シェルに入力の終わりを知らせます (これによりシェルは終了します)。バッファが空でなければ、alert コマンドと同じ動作をします。
<dd>vi-insert, vi-command: <kbd><code>\#</code></kbd>, <kbd><code>\^D</code></kbd>
<dt>eof-or-delete
<dd>バッファが空ならば、行編集を終了し、シェルに入力の終わりを知らせます (これによりシェルは終了します)。バッファが空でなければ、delete-char コマンドと同じ動作をします。
<dd>emacs: <kbd><code>\#</code></kbd>, <kbd><code>\^D</code></kbd>
<dt>accept-with-hash
<dd>引数が与えられていないかバッファの最初の文字が <code>#</code> でなければ、バッファの最初に <code>#</code> を挿入します。そうでなければバッファの最初の <code>#</code> を削除します。いずれの場合も、その後 accept-line コマンドと同じ動作をします。
<dd>vi-command: <kbd>#</kbd>
<dd>emacs: <kbd><code>\^[</code>#</kbd>
<dt>setmode-viinsert
<dd>編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd>i</kbd>, <kbd><code>\I</code></kbd>
<dt>setmode-vicommand
<dd>編集モードを vi 風編集モードのコマンドモードに変更します。
<dd>vi-insert: <kbd><code>\^[</code></kbd>
<dt>setmode-emacs
<dd>編集モードを emacs 風編集モードに変更します。
<dt>expect-char
<dt>abort-expect-char
<dd>これは find-char コマンドなどを実装するために yash 内部で使われているコマンドで、直接使用しても意味はありません。
<dt>redraw-all
<dd>行編集のプロンプトやバッファを端末に表示しなおします。
<dd>vi-insert, vi-command, vi-search, emacs, emacs-search: <kbd><code>\^L</code></kbd>
<dt>clear-and-redraw-all
<dd>端末の表示をクリアし、行編集のプロンプトやバッファを端末に表示しなおします。
</dl>

<h3 id="motion-commands">移動コマンド</h3><!--motion commands-->
<p><dfn>移動コマンド</dfn>はカーソルを移動させるコマンドです。ほとんどの移動コマンドは引数を与えることでそのコマンドを引数の回数だけ実行するのと同じように動作させられます。例えば forward-char コマンドに引数 4 を与えると、カーソルを 4 文字先に進めます。
<p>以下、<dfn>bigword</dfn> とは一文字以上の連続した空白でない文字をいい、<dfn>semiword</dfn> とは一文字以上の連続した空白でも句読点でもない文字をいい、<dfn>emacsword</dfn> とは一文字以上の連続した英数字をいいます。また <dfn>viword</dfn> とは以下のいずれかをいいます
<ul>
<li>一文字以上の連続したアルファベットまたは下線 (<code>_</code>)
<li>一文字以上の連続した、アルファベットでも下線でも空白でもない文字
</ul>
<p>以下に移動コマンドの一覧を示します。
<dl>
<dt>forward-char
<dd>カーソルを次の文字に移動します。
<dd>vi-insert: <kbd><code>\R</code></kbd>
<dd>vi-command: <kbd>l</kbd>, <kbd> </kbd> (空白文字), <kbd><code>\R</code></kbd>
<dd>emacs: <kbd><code>\R</code></kbd>, <kbd><code>\^F</code></kbd>
<dt>backward-char
<dd>カーソルを前の文字に移動します。
<dd>vi-insert: <kbd><code>\L</code></kbd>
<dd>vi-command: <kbd>h</kbd>, <kbd><code>\L</code></kbd>, <kbd><code>\B</code></kbd>, <kbd><code>\?</code></kbd>, <kbd><code>\^H</code></kbd>
<dd>emacs: <kbd><code>\L</code></kbd>, <kbd><code>\^B</code></kbd>
<dt>forward-bigword
<dd>カーソルを次の bigword に移動します。
<dd>vi-command: <kbd>W</kbd>
<dt>end-of-bigword
<dd>カーソルを bigword の終わりまで移動します。
<dd>vi-command: <kbd>E</kbd>
<dt>backward-bigword
<dd>カーソルを前の bigword に移動します。
<dd>vi-command: <kbd>B</kbd>
<dt>forward-semiword
<dd>カーソルを次の semiword に移動します。
<dt>end-of-semiword
<dd>カーソルを semiword の終わりまで移動します。
<dt>backward-semiword
<dd>カーソルを前の semiword に移動します。
<dt>forward-viword
<dd>カーソルを次の viword に移動します。
<dd>vi-command: <kbd>w</kbd>
<dt>end-of-viword
<dd>カーソルを viword の終わりまで移動します。
<dd>vi-command: <kbd>e</kbd>
<dt>backward-viword
<dd>カーソルを前の viword に移動します。
<dd>vi-command: <kbd>b</kbd>
<dt>forward-emacsword
<dd>カーソルを次の emacsword に移動します。
<dd>emacs: <kbd><code>\^[</code>f</kbd>, <kbd><code>\^[</code>F</kbd>
<dt>backward-emacsword
<dd>カーソルを前の emacsword に移動します。
<dd>emacs: <kbd><code>\^[</code>b</kbd>, <kbd><code>\^[</code>B</kbd>
<dt>beginning-of-line
<dd>カーソルをバッファの先頭に移動します。
<dd>vi-insert, vi-command: <kbd><code>\H</code></kbd>
<dd>emacs: <kbd><code>\H</code></kbd>, <kbd><code>\^A</code></kbd>
<dt>end-of-line
<dd>カーソルをバッファの末尾に移動します。
<dd>vi-insert: <kbd><code>\E</code></kbd>
<dd>vi-command: <kbd>$</kbd>, <kbd><code>\E</code></kbd>
<dd>emacs: <kbd><code>\E</code></kbd>, <kbd><code>\^E</code></kbd>
<dt>go-to-column
<dd>カーソルをバッファ内の <var>n</var> 文字目に移動します。ただし <var>n</var> は引数です (引数が与えられていない場合は 1)。
<dd>vi-command: <kbd>|</kbd>
<dt>first-nonblank
<dd>カーソルをバッファ内の最初の空白でない文字に移動します。
<dd>vi-command: <kbd>^</kbd>
<dt>find-char
<dd>このコマンドの直後に入力した文字がある位置までカーソルを進めます。
<dd>vi-command: <kbd>f</kbd>
<dd>emacs: <kbd><code>\^]</code></kbd>
<dt>find-char-rev
<dd>このコマンドの直後に入力した文字がある位置までカーソルを戻します。
<dd>vi-command: <kbd>F</kbd>
<dd>emacs: <kbd><code>\^[</code><code>\^]</code></kbd>
<dt>till-char
<dd>このコマンドの直後に入力した文字がある位置の直前までカーソルを進めます。
<dd>vi-command: <kbd>t</kbd>
<dt>till-char-rev
<dd>このコマンドの直後に入力した文字がある位置の直後までカーソルを戻します。
<dd>vi-command: <kbd>T</kbd>
<dt>refind-char
<dd>前回実行した find-char, find-char-rev, till-char, till-char-rev コマンドを再実行します。
<dd>vi-command: <kbd>;</kbd>
<dt>refind-char-rev
<dd>前回実行した find-char, find-char-rev, till-char, till-char-rev コマンドを、カーソルの進む向きを逆にして再実行します。
<dd>vi-command: <kbd>,</kbd>
</dl>

<h3 id="editing-commands">編集コマンド</h3>
<p>編集コマンドはバッファの内容を変更するコマンドです。ほとんどの編集コマンドは引数を与えることでそのコマンドを引数の回数だけ実行するのと同じように動作させられます。
<p>名前に kill が付くコマンドで削除した文字列は<dfn>キルリング</dfn>という場所に保管され、後で put などのコマンドでバッファに戻すことができます。
<p>以下に編集コマンドの一覧を示します。
<dl>
<dt>delete-char
<dd>カーソルのところにある文字を削除します。引数を与えた場合は kill-char コマンドと同じ動作をします。
<dd>vi-insert, emacs: <kbd><code>\X</code></kbd>
<dt>delete-bigword
<dd>カーソルのところにある bigword を削除します。引数を与えた場合は kill-bigword コマンドと同じ動作をします。
<dt>delete-semiword
<dd>カーソルのところにある semiword を削除します。引数を与えた場合は kill-semiword コマンドと同じ動作をします。
<dt>delete-viword
<dd>カーソルのところにある viword を削除します。引数を与えた場合は kill-viword コマンドと同じ動作をします。
<dt>delete-emacsword
<dd>カーソルのところにある emacsword を削除します。引数を与えた場合は kill-emacsword コマンドと同じ動作をします。
<dt>backward-delete-char
<dd>カーソルの前にある文字を削除します。引数を与えた場合は backward-kill-char コマンドと同じ動作をします。
<dd>vi-insert, emacs: <kbd><code>\B</code></kbd>, <kbd><code>\?</code></kbd>, <kbd><code>\^H</code></kbd>
<dt>backward-delete-bigword
<dd>カーソルの前にある bigword を削除します。引数を与えた場合は backward-kill-bigword コマンドと同じ動作をします。
<dt>backward-delete-semiword
<dd>カーソルの前にある semiword を削除します。引数を与えた場合は backward-kill-semiword コマンドと同じ動作をします。
<dd>vi-insert: <kbd><code>\^W</code></kbd>
<dt>backward-delete-viword
<dd>カーソルの前にある viword を削除します。引数を与えた場合は backward-kill-viword コマンドと同じ動作をします。
<dt>backward-delete-emacsword
<dd>カーソルの前にある emacsword を削除します。引数を与えた場合は backward-kill-emacsword コマンドと同じ動作をします。
<dt>delete-line
<dd>バッファの内容を全て削除します。
<dt>forward-delete-line
<dd>カーソル以降の全ての文字を削除します。
<dt>backward-delete-line
<dd>カーソルより前の全ての文字を削除します。
<dd>vi-insert: <kbd><code>\$</code></kbd>, <kbd><code>\^U</code></kbd>
<dt>kill-char
<dd>カーソルのところにある文字を削除し、キルリングに保管します。
<dd>vi-command: <kbd>x</kbd>, <kbd><code>\X</code></kbd>
<dt>kill-bigword
<dd>カーソルのところにある bigword を削除し、キルリングに保管します。
<dt>kill-semiword
<dd>カーソルのところにある semiword を削除し、キルリングに保管します。
<dt>kill-viword
<dd>カーソルのところにある viword を削除し、キルリングに保管します。
<dt>kill-emacsword
<dd>カーソルのところにある emacsword を削除し、キルリングに保管します。
<dd>emacs: <kbd><code>\^[</code>d</kbd>, <kbd><code>\^[</code>D</kbd>
<dt>backward-kill-char
<dd>カーソルの前にある文字を削除し、キルリングに保管します。
<dd>vi-command: <kbd>X</kbd>
<dt>backward-kill-bigword
<dd>カーソルの前にある bigword を削除し、キルリングに保管します。
<dd>emacs: <kbd><code>\^W</code></kbd>
<dt>backward-kill-semiword
<dd>カーソルの前にある semiword を削除し、キルリングに保管します。
<dt>backward-kill-viword
<dd>カーソルの前にある viword を削除し、キルリングに保管します。
<dt>backward-kill-emacsword
<dd>カーソルの前にある emacsword を削除し、キルリングに保管します。
<dd>emacs: <kbd><code>\^[</code><code>\B</code></kbd>, <kbd><code>\^[</code><code>\?</code></kbd>, <kbd><code>\^[</code><code>\^H</code></kbd>
<dt>kill-line
<dd>バッファの内容を全て削除し、キルリングに保管します。
<dt>forward-kill-line
<dd>カーソル以降の全ての文字を削除し、キルリングに保管します。
<dd>emacs: <kbd><code>\^K</code></kbd>
<dt>backward-kill-line
<dd>カーソルより前の全ての文字を削除し、キルリングに保管します。
<dd>emacs: <kbd><code>\$</code></kbd>, <kbd><code>\^U</code></kbd>, <kbd><code>\^X</code><code>\B</code></kbd>, <kbd><code>\^X</code><code>\?</code></kbd>
<dt>put-before
<dd>最後にキルリングに保管した文字列をカーソルの直前に挿入します。カーソルは挿入した文字列の最後の文字のところに移動します。
<dd>vi-command: <kbd>P</kbd>
<dt>put
<dd>最後にキルリングに保管した文字列をカーソルの直後に挿入します。カーソルは挿入した文字列の最後の文字のところに移動します。
<dd>vi-command: <kbd>p</kbd>
<dt>put-left
<dd>最後にキルリングに保管した文字列をカーソルの直前に挿入します。カーソルは挿入した文字列の直後に移動します。
<dd>emacs: <kbd><code>\^Y</code></kbd>
<dt>put-pop
<dd>このコマンドは put-before, put, put-left, put-pop コマンドの直後にだけ使えます。このコマンドは直前のコマンドでキルリングから挿入した文字列を削除し、代わりにその文字列の前にキルリングに保管した文字列を挿入します。
<dd>emacs: <kbd><code>\^[</code>y</kbd>, <kbd><code>\^[</code>Y</kbd>
<dt>undo
<dd>直前の編集コマンドを取り消し、バッファの内容を前の状態に戻します。
<dd>vi-command: <kbd>u</kbd>
<dd>emacs: <kbd><code>\^_</code></kbd>, <kbd><code>\^X</code><code>\$</code></kbd>, <kbd><code>\^X</code><code>\^U</code></kbd>
<dt>undo-all
<dd>全ての編集コマンドを取り消し、バッファの内容を初期状態に戻します。
<dd>vi-command: <kbd>U</kbd>
<dd>emacs: <kbd><code>\^[</code><code>\^R</code></kbd>, <kbd><code>\^[</code>r</kbd>, <kbd><code>\^[</code>R</kbd>
<dt>cancel-undo
<dd>undo, undo-all による編集コマンドの取り消しを取り消し、バッファの内容を復元します。
<dd>vi-command: <kbd><code>\^R</code></kbd>
<dt>cancel-undo-all
<dd>undo, undo-all による編集コマンドの取り消しを全て取り消し、バッファの内容を復元します。
<dt>redo
<dd>直前の編集コマンドを繰り返します。
<dd>vi-command: <kbd>.</kbd>
</dl>

<h3 id="completion-commands">補完コマンド</h3>
<dl>
<dt>complete
<dd>現在のカーソル位置で<a href="#completion">補完</a>を行います。補完候補が複数ある場合はその一覧を表示します。
<dt>complete-next-candidate
<dd>現在のカーソル位置で補完を行います。補完候補が複数ある場合は、一覧の中から次の候補を選択します。
<dd>vi-insert, emacs: <kbd><code>\^I</code></kbd>
<dt>complete-prev-candidate
<dd>現在のカーソル位置で補完を行います。補完候補が複数ある場合は、一覧の中から前の候補を選択します。
<dd>vi-insert, emacs: <kbd><code>\bt</code></kbd>
<dt>complete-next-column
<dd>現在のカーソル位置で補完を行います。補完候補が複数ある場合は、一覧の中から次の列の最初の候補を選択します。
<dt>complete-prev-column
<dd>現在のカーソル位置で補完を行います。補完候補が複数ある場合は、一覧の中から前の列の最初の候補を選択します。
<dt>complete-next-page
<dd>現在のカーソル位置で補完を行います。補完候補が複数ある場合は、一覧の中から次のページの最初の候補を選択します。
<dt>complete-prev-page
<dd>現在のカーソル位置で補完を行います。補完候補が複数ある場合は、一覧の中から前のページの最初の候補を選択します。
<dt>complete-list
<dd>現在のカーソル位置で補完を行います。引数を指定しない場合、補完候補の一覧を表示します。引数を指定すると、その番号の候補で補完内容を確定します。
<dd>emacs: <kbd><code>\^[</code>?</kbd>, <kbd><code>\^[</code>=</kbd>
<dt>complete-all
<dd>現在のカーソル位置で補完を行い、カーソル位置にある単語をすべての補完候補で置き換えます。
<dd>emacs: <kbd><code>\^[</code>*</kbd>
<dt>complete-max
<dd>現在のカーソル位置で補完を行い、各補完候補の最長共通先頭部分をカーソル位置に挿入します。
<dt>clear-candidates
<dd>補完候補の一覧を消去します。
</dl>

<h3 id="vi-commands">Vi 固有のコマンド</h3>
<dl>
<dt>vi-replace-char
<dd>カーソルのところにある文字を、このコマンドの直後に入力した文字に置き換えます。
<dd>vi-command: <kbd>r</kbd>
<dt>vi-insert-beginning
<dd>カーソルをバッファの先頭に移動したのち、setmode-viinsert コマンドと同じ動作をします。
<dd>vi-command: <kbd>I</kbd>
<dt>vi-append
<dd>カーソルを次の文字に移動したのち、setmode-viinsert コマンドと同じ動作をします。
<dd>vi-command: <kbd>a</kbd>
<dt>vi-append-to-eol
<dd>カーソルをバッファの末尾に移動したのち、setmode-viinsert コマンドと同じ動作をします。
<dd>vi-command: <kbd>A</kbd>
<dt>vi-replace
<dd>Setmode-viinsert コマンドと同じ動作をしますが、同時に上書きモードを有効にします。上書きモードでは、self-insert コマンドは文字を挿入する代わりにカーソルのところにある文字を置き換えます。上書きモードは編集モードを変更するまで有効です。
<dd>vi-command: <kbd>R</kbd>
<dt>vi-switch-case
<dd>このコマンドの直後には移動コマンドを入力する必要があります。移動コマンドが動かしたカーソルの範囲にある文字の大文字と小文字を入れ替えます。
<dt>vi-switch-case-char
<dd>カーソルのところにある文字の大文字と小文字を入れ替えて、カーソルを次の文字に移動します。
<dd>vi-command: <kbd>~</kbd>
<dt>vi-yank
<dd>このコマンドの直後には移動コマンドを入力する必要があります。移動コマンドが動かしたカーソルの範囲にある文字をキルリングに保管します。
<dd>vi-command: <kbd>y</kbd>
<dt>vi-yank-to-eol
<dd>カーソルの位置からバッファの末尾までにある文字をキルリングに保管します。
<dd>vi-command: <kbd>Y</kbd>
<dt>vi-delete
<dd>このコマンドの直後には移動コマンドを入力する必要があります。移動コマンドが動かしたカーソルの範囲にある文字を削除し、キルリングに保管します。
<dd>vi-command: <kbd>d</kbd>
<dt>vi-delete-to-eol
<dd>カーソルの位置からバッファの末尾までにある文字を削除し、キルリングに保管します。
<dd>vi-command: <kbd>D</kbd>
<dt>vi-change
<dd>このコマンドの直後には移動コマンドを入力する必要があります。移動コマンドが動かしたカーソルの範囲にある文字を削除し、その後編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd>c</kbd>
<dt>vi-change-to-eol
<dd>カーソルの位置からバッファの末尾までにある文字を削除し、その後編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd>C</kbd>
<dt>vi-change-line
<dd>バッファの内容を全て削除し、その後編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd>S</kbd>
<dt>vi-yank-and-change
<dd>このコマンドの直後には移動コマンドを入力する必要があります。移動コマンドが動かしたカーソルの範囲にある文字を削除しキルリングに保管した後、編集モードを vi 風編集モードの挿入モードに変更します。
<dt>vi-yank-and-change-to-eol
<dd>カーソルの位置からバッファの末尾までにある文字を削除しキルリングに保管した後、編集モードを vi 風編集モードの挿入モードに変更します。
<dt>vi-yank-and-change-line
<dd>バッファの内容を全て削除しキルリングに保管した後、編集モードを vi 風編集モードの挿入モードに変更します。
<dt>vi-substitute
<dd>カーソルのところにある文字を削除しキルリングに保管した後、編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd>s</kbd>
<dt>vi-append-last-bigword
<dd><a href="interact.html#history">コマンド履歴</a>の中で最も新しいコマンドにおける最後の bigword を、空白文字に続けてカーソルの位置の直後に挿入します。引数 <var>n</var> を与えたときは最後の bigword の代わりに <var>n</var> 番目の bigword を挿入します。その後、setmode-viinsert コマンドと同じ動作をします。
<dd>vi-command: <kbd>_</kbd>
<dt>vi-exec-alias
<dd>このコマンドの直後に入力した文字を <var>c</var> とすると、<code>_<var>c</var></code> という名前の<a href="syntax.html#aliases">エイリアス</a>の内容をシェルへの入力とみなして行編集コマンドとして解釈・実行します。
<dd>vi-command: <kbd>@</kbd>
<dt>vi-edit-and-accept
<dd>エディタとして vi を起動し、バッファの内容を編集させます。エディタが終了すると編集後の内容をバッファに反映した後 accept-line コマンドと同じ動作をします。ただしエディタの終了ステータスが 0 でないときは何も行いません。
<dd>vi-command: <kbd>v</kbd>
<dt>vi-complete-list
<dd>Complete-list コマンドと同様ですが、候補を確定したとき編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd>=</kbd>
<dt>vi-complete-all
<dd>Complete-all コマンドと同様ですが、単語を置き換えた後、編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd>*</kbd>
<dt>vi-complete-max
<dd>Complete-max コマンドと同様ですが、候補を挿入した後、編集モードを vi 風編集モードの挿入モードに変更します。
<dd>vi-command: <kbd><code>\\</code></kbd>
<dt>vi-search-forward
<dd>順方向の履歴検索を開始します。編集モードを vi 風編集モードの検索モードに変更します。
<dd>vi-command: <kbd>?</kbd>
<dt>vi-search-backward
<dd>逆方向の履歴検索を開始します。編集モードを vi 風編集モードの検索モードに変更します。
<dd>vi-command: <kbd>/</kbd>
</dl>

<h3 id="emacs-commands">Emacs 固有のコマンド</h3>
<dl>
<dt>emacs-transpose-chars
<dd>カーソルの前にある文字を右に移動します。
<dd>emacs: <kbd><code>\^T</code></kbd>
<dt>emacs-transpose-words
<dd>カーソルの前にある emacsword を右に移動します。
<dd>emacs: <kbd><code>\^[</code>t</kbd>, <kbd><code>\^[</code>T</kbd>
<dt>emacs-downcase-word
<dd>カーソルの後にある emacsword を小文字に変換します。
<dd>emacs: <kbd><code>\^[</code>l</kbd>, <kbd><code>\^[</code>L</kbd>
<dt>emacs-upcase-word
<dd>カーソルの後にある emacsword を大文字に変換します。
<dd>emacs: <kbd><code>\^[</code>u</kbd>, <kbd><code>\^[</code>U</kbd>
<dt>emacs-capitalize-word
<dd>カーソルの後にある emacsword をキャピタライズ (各単語の頭文字だけ大文字にする) します。
<dd>emacs: <kbd><code>\^[</code>c</kbd>, <kbd><code>\^[</code>C</kbd>
<dt>emacs-delete-horizontal-space
<dd>カーソルの前後にある空白を削除します。引数を与えるとカーソルの前にある空白を削除します。
<dd>emacs: <kbd><code>\^[</code><code>\\</code></kbd>
<dt>emacs-just-one-space
<dd>カーソルの前後にある空白の個数を一つに調整します。引数を与えるとその引数の数だけ空白を残します。
<dd>emacs: <kbd><code>\^[</code> </kbd> (Escape の後に空白文字)
<dt>emacs-search-forward
<dd>順方向の履歴検索を開始します。編集モードを emacs 風編集モードの検索モードに変更します。
<dd>emacs: <kbd><code>\^S</code></kbd>
<dt>emacs-search-backward
<dd>順方向の履歴検索を開始します。編集モードを emacs 風編集モードの検索モードに変更します。
<dd>emacs: <kbd><code>\^R</code></kbd>
</dl>

<h3 id="history-commands">コマンド履歴関連のコマンド</h3>
<dl>
<dt>oldest-history
<dd>コマンド履歴の中で最も古いコマンドに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルの位置は変わりません。
<dt>newest-history
<dd>コマンド履歴の中で最も新しいコマンドに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルの位置は変わりません。
<dt>return-history
<dd>コマンド履歴のどのコマンドにも対応しない新規バッファに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルの位置は変わりません。
<dt>oldest-history-bol
<dd>コマンド履歴の中で最も古いコマンドに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルはバッファの先頭に移動します。
<dd>vi-command: <kbd>G</kbd>
<dt>newest-history-bol
<dd>コマンド履歴の中で最も新しいコマンドに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルはバッファの先頭に移動します。
<dt>return-history-bol
<dd>コマンド履歴のどのコマンドにも対応しない新規バッファに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルはバッファの先頭に移動します。
<dd>vi-command: <kbd>g</kbd>
<dt>oldest-history-eol
<dd>コマンド履歴の中で最も古いコマンドに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルはバッファの末尾に移動します。
<dd>emacs: <kbd><code>\^[</code>&lt;</kbd>
<dt>newest-history-eol
<dd>コマンド履歴の中で最も新しいコマンドに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルはバッファの末尾に移動します。
<dt>return-history-eol
<dd>コマンド履歴のどのコマンドにも対応しない新規バッファに移動します。引数を与えるとそれを履歴番号とみなしてその番号のコマンドに移動します。カーソルはバッファの末尾に移動します。
<dd>emacs: <kbd><code>\^[</code>&gt;</kbd>
<dt>next-history
<dd>コマンド履歴の中で次のコマンドに移動します。カーソルの位置は変わりません。
<dt>prev-history
<dd>コマンド履歴の中で前のコマンドに移動します。カーソルの位置は変わりません。
<dt>next-history-bol
<dd>コマンド履歴の中で次のコマンドに移動します。カーソルはバッファの先頭に移動します
<dd>vi-command: <kbd>j</kbd>, <kbd>+</kbd>, <kbd><code>\D</code></kbd>, <kbd><code>\^N</code></kbd>
<dt>prev-history-bol
<dd>コマンド履歴の中で前のコマンドに移動します。カーソルはバッファの先頭に移動します
<dd>vi-command: <kbd>k</kbd>, <kbd>-</kbd>, <kbd><code>\U</code></kbd>, <kbd><code>\^P</code></kbd>
<dt>next-history-eol
<dd>コマンド履歴の中で次のコマンドに移動します。カーソルはバッファの末尾に移動します
<dd>vi-insert, emacs: <kbd><code>\D</code></kbd>, <kbd><code>\^N</code></kbd>
<dt>prev-history-eol
<dd>コマンド履歴の中で前のコマンドに移動します。カーソルはバッファの末尾に移動します
<dd>vi-insert, emacs: <kbd><code>\U</code></kbd>, <kbd><code>\^P</code></kbd>
<dt>search-again
<dd>最後に行ったコマンド履歴検索をもう一度行います。
<dd>vi-command: <kbd>n</kbd>
<dt>search-again-rev
<dd>最後に行ったコマンド履歴検索を方向を逆にしてもう一度行います。
<dd>vi-command: <kbd>N</kbd>
<dt>search-again-forward
<dd>最後に行ったコマンド履歴検索を順方向にもう一度行います。
<dt>search-again-backward
<dd>最後に行ったコマンド履歴検索を逆方向にもう一度行います。
<dt>beginning-search-forward
<dd>コマンド履歴を順方向に検索し、バッファの先頭から現在のカーソル位置までの間にある文字列が同じ次のコマンドに移動します。カーソル位置は変わりません。
<dt>beginning-search-backward
<dd>コマンド履歴を逆方向に検索し、バッファの先頭から現在のカーソル位置までの間にある文字列が同じ前のコマンドに移動します。カーソル位置は変わりません。
</dl>

<h3 id="search-commands">コマンド履歴検索モードのコマンド</h3>
<dl>
<dt>srch-self-insert
<dd>入力した文字を検索用バッファに挿入します。(<a href="#escape">エスケープシーケンス</a>によるエスケープの対象となる文字は挿入できません)
<dd>vi-search, emacs-search: <kbd><code>\\</code></kbd>
<dt>srch-backward-delete-char
<dd>検索用バッファの最後の一文字を削除します。
<dd>検索用バッファが空の場合、vi 風編集モードでは srch-abort-search コマンドと同じ動作をします。
<dd>検索用バッファが空の場合、emacs 風編集モードでは alert コマンドと同じ動作をします。
<dd>vi-search, emacs-search: <kbd><code>\B</code></kbd>, <kbd><code>\?</code></kbd>, <kbd><code>\^H</code></kbd>
<dt>srch-backward-delete-line
<dd>検索用バッファの内容を全て削除します。
<dd>vi-search, emacs-search: <kbd><code>\$</code></kbd>, <kbd><code>\^U</code></kbd>
<dt>srch-continue-forward
<dd>現在表示している暫定検索結果の次の結果を順方向に探します。
<dd>emacs-search: <kbd><code>\^S</code></kbd>
<dt>srch-continue-backward
<dd>現在表示している暫定検索結果の次の結果を逆方向に探します。
<dd>emacs-search: <kbd><code>\^R</code></kbd>
<dt>srch-accept-search
<dd>検索を終了し、現在表示している暫定検索結果を確定します。検索結果に移動します。
<dd>vi-search: <kbd><code>\^J</code></kbd>, <kbd><code>\^M</code></kbd>
<dd>emacs-search: <kbd><code>\^J</code></kbd>, <kbd><code>\^[</code></kbd>
<dt>srch-abort-search
<dd>検索を中止し、検索を開始する前の状態に戻ります。
<dd>vi-search: <kbd><code>\^[</code></kbd>
<dd>emacs-search: <kbd><code>\^G</code></kbd>
</dl>

<h2 id="escape">エスケープシーケンス</h2>
<p><a href="bi/bindkey.html">Bindkey コマンド</a>で行編集のキー設定を表示・設定する際、ファンクションキーなどの特殊なキーはエスケープシーケンスで表わします。エスケープシーケンスは全てバックスラッシュ (<code>\</code>) で始まります。またバックスラッシュそのものもエスケープの対象です。エスケープシーケンスとキーの対照は以下の通りです。
<dl>
<dt><code>\\</code><dd>バックスラッシュ (<code>\</code>)
<dt><code>\B</code><dd>Backspace
<dt><code>\D</code><dd>↓矢印キー
<dt><code>\E</code><dd>End
<dt><code>\H</code><dd>Home
<dt><code>\I</code><dd>Insert (Insert-char, Enter-insert-mode)
<dt><code>\L</code><dd>←矢印キー
<dt><code>\N</code><dd>Page-down (Next-page)
<dt><code>\P</code><dd>Page-up (Previous-page)
<dt><code>\R</code><dd>→矢印キー
<dt><code>\U</code><dd>↑矢印キー
<dt><code>\X</code><dd>Delete
<dt><code>\!</code><dd>INTR
<dt><code>\#</code><dd>EOF
<dt><code>\$</code><dd>KILL
<dt><code>\?</code><dd>ERASE
<dt><code>\^@</code><dd>Ctrl + @
<dt><code>\^A</code>, <code>\^B</code>, …, <code>\^Z</code><dd>Ctrl + A, Ctrl + B, …, Ctrl + Z
<dd>※ Ctrl + I は Tab、Ctrl + J は Newline、Ctrl + M は Carriage-return です。
<dt><code>\^[</code><dd>Ctrl + [ (Escape)
<dt><code>\^\</code><dd>Ctrl + \
<dt><code>\^]</code><dd>Ctrl + ]
<dt><code>\^^</code><dd>Ctrl + ^
<dt><code>\^_</code><dd>Ctrl + _
<dt><code>\^?</code><dd>Ctrl + ? (Delete)
<dt><code>\F00</code>, <code>F01</code>, …, <code>\F63</code><dd>F0, F1, …, F63
<dt><code>\a1</code><dd>キーパッドの左上キー
<dt><code>\a3</code><dd>キーパッドの右上キー
<dt><code>\b2</code><dd>キーパッドの中央キー
<dt><code>\bg</code><dd>Beginning
<dt><code>\bt</code><dd>Back-tab
<dt><code>\c1</code><dd>キーパッドの左下キー
<dt><code>\c3</code><dd>キーパッドの右下キー
<dt><code>\ca</code><dd>Clear-all-tabs
<dt><code>\cl</code><dd>Close
<dt><code>\cn</code><dd>Cancel
<dt><code>\co</code><dd>Command
<dt><code>\cp</code><dd>Copy
<dt><code>\cr</code><dd>Create
<dt><code>\cs</code><dd>Clear-screen または erase
<dt><code>\ct</code><dd>Clear-tab
<dt><code>\dl</code><dd>Delete-line
<dt><code>\ei</code><dd>Exit-insert-mode
<dt><code>\el</code><dd>Clear-to-end-of-line
<dt><code>\es</code><dd>Clear-to-end-of-screen
<dt><code>\et</code><dd>Enter (Send)
<dt><code>\ex</code><dd>Exit
<dt><code>\fd</code><dd>Find
<dt><code>\hp</code><dd>Help
<dt><code>\il</code><dd>Insert-line
<dt><code>\ll</code><dd>Home-down
<dt><code>\me</code><dd>Message
<dt><code>\mk</code><dd>Mark
<dt><code>\ms</code><dd>マウスイベント
<dt><code>\mv</code><dd>Move
<dt><code>\nx</code><dd>Next-object
<dt><code>\on</code><dd>Open
<dt><code>\op</code><dd>Options
<dt><code>\pr</code><dd>Print (Copy)
<dt><code>\pv</code><dd>Previous-object
<dt><code>\rd</code><dd>Redo
<dt><code>\re</code><dd>Resume
<dt><code>\rf</code><dd>Ref (Reference)
<dt><code>\rh</code><dd>Refresh
<dt><code>\rp</code><dd>Replace
<dt><code>\rs</code><dd>Restart
<dt><code>\sf</code><dd>Scroll-forward (Scroll-down)
<dt><code>\sl</code><dd>Select
<dt><code>\sr</code><dd>Scroll-backward (Scroll-up)
<dt><code>\st</code><dd>Set-tab
<dt><code>\su</code><dd>Suspend
<dt><code>\sv</code><dd>Save
<dt><code>\ud</code><dd>Undo
<dt><code>\SE</code><dd>Shift + End
<dt><code>\SH</code><dd>Shift + Home
<dt><code>\SI</code><dd>Shift + Insert
<dt><code>\SL</code><dd>Shift + ←矢印キー
<dt><code>\SR</code><dd>Shift + →矢印キー
<dt><code>\SX</code><dd>Shift + Delete
<dt><code>\Sbg</code><dd>Shift + Beginning
<dt><code>\Scn</code><dd>Shift + Cancel
<dt><code>\Sco</code><dd>Shift + Command
<dt><code>\Scp</code><dd>Shift + Copy
<dt><code>\Scr</code><dd>Shift + Create
<dt><code>\Sdl</code><dd>Shift + Delete-line
<dt><code>\Sel</code><dd>Shift + End-of-line
<dt><code>\Sex</code><dd>Shift + Exit
<dt><code>\Sfd</code><dd>Shift + Find
<dt><code>\Shp</code><dd>Shift + Help
<dt><code>\Smg</code><dd>Shift + Message
<dt><code>\Smv</code><dd>Shift + Move
<dt><code>\Snx</code><dd>Shift + Next
<dt><code>\Sop</code><dd>Shift + Options
<dt><code>\Spr</code><dd>Shift + Print
<dt><code>\Spv</code><dd>Shift + Previous
<dt><code>\Srd</code><dd>Shift + Redo
<dt><code>\Sre</code><dd>Shift + Resume
<dt><code>\Srp</code><dd>Shift + Replace
<dt><code>\Ssu</code><dd>Shift + Suspend
<dt><code>\Ssv</code><dd>Shift + Save
<dt><code>\Sud</code><dd>Shift + Undo
</dl>
<p>INTR, EOF, KILL, ERASE の四つは stty コマンドなどで設定される端末の特殊文字<!--special characters-->です。一般的な環境では、INTR は Ctrl + C に、EOF は Ctrl + D に、KILL は Ctrl + U に、ERASE は Ctrl + H または Ctrl + ? に設定されています。これら四つは他のキー入力よりも優先して認識されます。

<h2 id="completion">コマンドライン補完</h2>
<p>行編集でコマンドを入力している途中で Tab キーを押すことで、コマンドの名前やオプション、引数を補完することができます。コマンド名やファイル名を途中まで打ち込んだところで Tab キーを押すと、その名前に一致するコマンド名やファイル名の一覧が現れます。さらに続けて Tab キーを押すと、入力したい名前を一覧の中から選ぶことができます。(一致する名前が一つしかない場合は、一覧は現れず、直接名前がコマンドラインに入力されます。)
<p>補完の対象となる名前に <code>*</code> や <code>?</code> などの文字が入っている場合は、その<a href="pattern.html">パターン</a>に一致する名前全てがコマンドラインに展開されます。(一覧による選択はできません)
<p>コマンドのオプションや引数を補完する際は、補完の内容を予め <a href="bi/complete.html">complete コマンド</a>で設定しておくことで、コマンドの種類に応じて異なる内容の補完をさせることができます。
